<!DOCTYPE html>
 <html>
   <head>
   <title>Script</title>
   <meta charset="utf-8">
  </head>
  <style type="text/css">
   body {
     background-color: #2ecc71;
     color: white;
   }
   </style>
 <body>
import requests
import pandas as pd
import sqlalchemy

def lambda_handler(event,context):
    #TODO implement
    url = 'https://opendata.datainfogreffe.fr/explore/dataset/statistiques-radiations-en-2020/table/'
    panorama = request.get(url).content
    panorama = json.loads(panorama)
    x=[line['fields'] for line in panorama]
    df = pd.Dataframe(x)
    df['coordonnées_geo'] = df['coordonnées_geo'].astype(str)
    #db_url = 'mysql+pymysql://admin:#GCP '
    db_connection = sqlalchemy.create_engine(db_url)
    df.to_sql('RCS', db_connnection, if_exists='append', index=False)
    db_connection.dispose()
    print(df.shape)
    print("database updated")
   </body>

</html>